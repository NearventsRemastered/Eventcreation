{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Geolocation from '@react-native-community/geolocation';\nimport axios from 'axios';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function App() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    userLocation = _useState2[0],\n    setUserLocation = _useState2[1];\n  useEffect(function () {\n    Geolocation.getCurrentPosition(function (position) {\n      var _position$coords = position.coords,\n        latitude = _position$coords.latitude,\n        longitude = _position$coords.longitude;\n      setUserLocation({\n        latitude: latitude,\n        longitude: longitude\n      });\n    }, function (error) {\n      return console.log(error);\n    }, {\n      enableHighAccuracy: true,\n      timeout: 20000,\n      maximumAge: 1000\n    });\n  }, []);\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    data = _useState4[0],\n    setData = _useState4[1];\n  useEffect(function () {\n    axios.get('https://analisi.transparenciacatalunya.cat/resource/rhpv-yr4f.json').then(function (response) {\n      return setData(response.data);\n    }).catch(function (error) {\n      return console.error(error);\n    });\n  }, []);\n  var filteredData = filterByTerminated(filterByDistance(data, userLocation, distance));\n  return _jsx(View, {\n    style: styles.container,\n    children: filteredData && filteredData.length > 0 ? filteredData.map(function (item) {\n      return _jsx(View, {\n        children: _jsx(Text, {\n          children: item.denominaci\n        })\n      }, item.codi);\n    }) : _jsx(Text, {\n      children: \"Loading...\"\n    })\n  });\n}\nvar EARTH_RADIUS = 6371;\nvar distance = 10;\nvar filterByDistance = function filterByDistance(data, userLocation, distance) {\n  if (!data) {\n    return [];\n  }\n  return data.filter(function (item) {\n    var dLat = deg2rad(item.lat - userLocation.latitude);\n    var dLon = deg2rad(item.lon - userLocation.longitude);\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(userLocation.latitude)) * Math.cos(deg2rad(item.lat)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = EARTH_RADIUS * c;\n    return d <= distance;\n  });\n};\nvar deg2rad = function deg2rad(deg) {\n  return deg * (Math.PI / 180);\n};\nvar filterByTerminated = function filterByTerminated(data) {\n  return data.filter(function (item) {\n    return item.data_fi !== null;\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","StyleSheet","Text","View","Geolocation","axios","jsx","_jsx","App","_useState","_useState2","_slicedToArray","userLocation","setUserLocation","getCurrentPosition","position","_position$coords","coords","latitude","longitude","error","console","log","enableHighAccuracy","timeout","maximumAge","_useState3","_useState4","data","setData","get","then","response","catch","filteredData","filterByTerminated","filterByDistance","distance","style","styles","container","children","length","map","item","denominaci","codi","EARTH_RADIUS","filter","dLat","deg2rad","lat","dLon","lon","a","Math","sin","cos","c","atan2","sqrt","d","deg","PI","data_fi","create","flex","backgroundColor","alignItems","justifyContent"],"sources":["C:/Users/Jordi/Desktop/apiex/MiProyecto/src/ApiExample.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { StyleSheet, Text, View } from 'react-native';\r\nimport Geolocation from '@react-native-community/geolocation';\r\nimport axios from 'axios';\r\n\r\nexport default function App() {\r\n  const [userLocation, setUserLocation] = useState(null);\r\n\r\n  useEffect(() => {\r\n    Geolocation.getCurrentPosition(\r\n      position => {\r\n        const { latitude, longitude } = position.coords;\r\n        setUserLocation({ latitude, longitude });\r\n      },\r\n      error => console.log(error),\r\n      { enableHighAccuracy: true, timeout: 20000, maximumAge: 1000 }\r\n    );\r\n  }, []);\r\n  const [data, setData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    axios.get('https://analisi.transparenciacatalunya.cat/resource/rhpv-yr4f.json')\r\n      .then(response => setData(response.data))\r\n      .catch(error => console.error(error));\r\n  }, []);\r\n  const filteredData = filterByTerminated(filterByDistance(data, userLocation, distance));\r\n  return (\r\n    <View style={styles.container}>\r\n      {filteredData && filteredData.length > 0 ? (\r\n        filteredData.map(item => (\r\n          <View key={item.codi}>\r\n            <Text>{item.denominaci}</Text>\r\n          </View>\r\n        ))\r\n      ) : (\r\n        <Text>Loading...</Text>\r\n      )}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst EARTH_RADIUS = 6371; // Radio de la Tierra en km\r\nconst distance=10;\r\n\r\nconst filterByDistance = (data, userLocation, distance) => {\r\n  if (!data) {\r\n    return [];\r\n  }\r\n  return data.filter(item => {\r\n    const dLat = deg2rad(item.lat - userLocation.latitude);\r\n    const dLon = deg2rad(item.lon - userLocation.longitude);\r\n    const a =\r\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n      Math.cos(deg2rad(userLocation.latitude)) *\r\n        Math.cos(deg2rad(item.lat)) *\r\n        Math.sin(dLon / 2) *\r\n        Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    const d = EARTH_RADIUS * c; // Distancia en km\r\n    return d <= distance;\r\n  });\r\n};\r\n\r\nconst deg2rad = deg => {\r\n  return deg * (Math.PI / 180);\r\n};\r\n\r\nconst filterByTerminated = data => {\r\n  return data.filter(item => {\r\n    return item.data_fi !== null;\r\n  });\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}