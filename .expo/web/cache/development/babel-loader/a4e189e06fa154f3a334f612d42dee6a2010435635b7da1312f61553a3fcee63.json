{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Geolocation from '@react-native-community/geolocation';\nimport axios from 'axios';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function App() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    events = _useState2[0],\n    setEvents = _useState2[1];\n  useEffect(function () {\n    Geolocation.getCurrentPosition(function (position) {\n      var _position$coords = position.coords,\n        latitude = _position$coords.latitude,\n        longitude = _position$coords.longitude;\n      axios.get(\"https://analisi.transparenciacatalunya.cat/resource/rhpv-yr4f.json?$where=fi_data>'\" + getCurrentDate() + \"'\").then(function (response) {\n        var filteredEvents = response.data.filter(function (event) {\n          var eventLat = parseFloat(event.latitud.replace(',', '.'));\n          var eventLon = parseFloat(event.longitud.replace(',', '.'));\n          var distance = getDistance({\n            lat: latitude,\n            lon: longitude\n          }, {\n            lat: eventLat,\n            lon: eventLon\n          });\n          return distance <= 10;\n        });\n        setEvents(filteredEvents.map(function (event) {\n          return event.denominaci;\n        }));\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }, function (error) {\n      return console.error(error);\n    }, {\n      enableHighAccuracy: true,\n      timeout: 20000,\n      maximumAge: 1000\n    });\n  }, []);\n  var getCurrentDate = function getCurrentDate() {\n    var today = new Date();\n    var year = today.getFullYear();\n    var month = ('0' + (today.getMonth() + 1)).slice(-2);\n    var day = ('0' + today.getDate()).slice(-2);\n    return year + \"-\" + month + \"-\" + day;\n  };\n  var getDistance = function getDistance(start, end) {\n    var deg2rad = function deg2rad(deg) {\n      return deg * (Math.PI / 180);\n    };\n    var R = 6371;\n    var dLat = deg2rad(end.lat - start.lat);\n    var dLon = deg2rad(end.lon - start.lon);\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(start.lat)) * Math.cos(deg2rad(end.lat)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = R * c;\n    return d;\n  };\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(Text, {\n      children: \"Events:\"\n    }), events.map(function (event, index) {\n      return _jsx(Text, {\n        children: event\n      }, index);\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","StyleSheet","Text","View","Geolocation","axios","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","events","setEvents","getCurrentPosition","position","_position$coords","coords","latitude","longitude","get","getCurrentDate","then","response","filteredEvents","data","filter","event","eventLat","parseFloat","latitud","replace","eventLon","longitud","distance","getDistance","lat","lon","map","denominaci","catch","error","console","enableHighAccuracy","timeout","maximumAge","today","Date","year","getFullYear","month","getMonth","slice","day","getDate","start","end","deg2rad","deg","Math","PI","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","d","style","styles","container","children","index","create","flex","backgroundColor","alignItems","justifyContent"],"sources":["C:/Users/Jordi/Desktop/apiex/MiProyecto/src/ApiExample.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { StyleSheet, Text, View } from 'react-native';\r\nimport Geolocation from '@react-native-community/geolocation';\r\nimport axios from 'axios';\r\n\r\nexport default function App() {\r\n  const [events, setEvents] = useState([]);\r\n\r\n  useEffect(() => {\r\n    Geolocation.getCurrentPosition(\r\n      (position) => {\r\n        const { latitude, longitude } = position.coords;\r\n        axios\r\n          .get(\r\n            `https://analisi.transparenciacatalunya.cat/resource/rhpv-yr4f.json?$where=fi_data>'${getCurrentDate()}'`\r\n          )\r\n          .then((response) => {\r\n            const filteredEvents = response.data.filter((event) => {\r\n              const eventLat = parseFloat(event.latitud.replace(',', '.'));\r\n              const eventLon = parseFloat(event.longitud.replace(',', '.'));\r\n              const distance = getDistance(\r\n                { lat: latitude, lon: longitude },\r\n                { lat: eventLat, lon: eventLon }\r\n              );\r\n              return distance <= 10;\r\n            });\r\n            setEvents(filteredEvents.map((event) => event.denominaci));\r\n          })\r\n          .catch((error) => {\r\n            console.error(error);\r\n          });\r\n      },\r\n      (error) => console.error(error),\r\n      { enableHighAccuracy: true, timeout: 20000, maximumAge: 1000 }\r\n    );\r\n  }, []);\r\n\r\n  const getCurrentDate = () => {\r\n    const today = new Date();\r\n    const year = today.getFullYear();\r\n    const month = ('0' + (today.getMonth() + 1)).slice(-2);\r\n    const day = ('0' + today.getDate()).slice(-2);\r\n    return `${year}-${month}-${day}`;\r\n  };\r\n\r\n  const getDistance = (start, end) => {\r\n    const deg2rad = (deg) => deg * (Math.PI / 180);\r\n    const R = 6371; // Earth's radius in km\r\n    const dLat = deg2rad(end.lat - start.lat);\r\n    const dLon = deg2rad(end.lon - start.lon);\r\n    const a =\r\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n      Math.cos(deg2rad(start.lat)) *\r\n        Math.cos(deg2rad(end.lat)) *\r\n        Math.sin(dLon / 2) *\r\n        Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    const d = R * c;\r\n    return d;\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text>Events:</Text>\r\n      {events.map((event, index) => (\r\n        <Text key={index}>{event}</Text>\r\n      ))}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}