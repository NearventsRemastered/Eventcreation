{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport axios from 'axios';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function App() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    actesCulturals = _useState2[0],\n    setActesCulturals = _useState2[1];\n  var filterByDistance = function filterByDistance(data) {\n    var currentLocation = {\n      lat: 40.8124900,\n      lon: 0.5216000\n    };\n    var filteredData = data.filter(function (acteCultural) {\n      if (acteCultural.latitud === null || acteCultural.longitud === null || acteCultural.fi_data < new Date().toISOString().slice(0, 10)) {\n        return false;\n      }\n      var distance = getDistance(currentLocation, {\n        lat: parseFloat(acteCultural.latitud),\n        lon: parseFloat(acteCultural.longitud)\n      });\n      return distance <= 10;\n    });\n    return filteredData;\n  };\n  var getDistance = function getDistance(start, end) {\n    var deg2rad = function deg2rad(deg) {\n      return deg * (Math.PI / 180);\n    };\n    var R = 6371;\n    var dLat = deg2rad(end.lat - start.lat);\n    var dLon = deg2rad(end.lon - start.lon);\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(start.lat)) * Math.cos(deg2rad(end.lat)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = R * c;\n    return d;\n  };\n  useEffect(function () {\n    var currentDate = new Date();\n    var formattedDate = currentDate.toISOString().substring(0, 10);\n    axios.get('https://analisi.transparenciacatalunya.cat/resource/rhpv-yr4f.json?$where=data_fi>%27' + formattedDate + '%27').then(function (response) {\n      var filteredData = filterByDistance(response.data);\n      setActesCulturals(filteredData.map(function (acteCultural) {\n        return acteCultural;\n      }));\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }, []);\n  return _jsx(View, {\n    style: styles.container,\n    children: actesCulturals.map(function (acteCultural, index) {\n      return _jsx(Text, {\n        children: acteCultural\n      }, index);\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","StyleSheet","Text","View","axios","jsx","_jsx","App","_useState","_useState2","_slicedToArray","actesCulturals","setActesCulturals","filterByDistance","data","currentLocation","lat","lon","filteredData","filter","acteCultural","latitud","longitud","fi_data","Date","toISOString","slice","distance","getDistance","parseFloat","start","end","deg2rad","deg","Math","PI","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","d","currentDate","formattedDate","substring","get","then","response","map","catch","error","console","log","style","styles","container","children","index","create","flex","backgroundColor","alignItems","justifyContent"],"sources":["C:/Users/Jordi/Desktop/apiex/MiProyecto/src/ApiExample.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { StyleSheet, Text, View } from 'react-native';\r\nimport axios from 'axios';\r\n\r\nexport default function App() {\r\n  const [actesCulturals, setActesCulturals] = useState([]);\r\n\r\n  const filterByDistance = (data) => {\r\n    const currentLocation = { lat: 40.8124900, lon:  0.5216000 }; // coordenadas de ejemplo\r\n    const filteredData = data.filter((acteCultural) => {\r\n      if (\r\n        acteCultural.latitud === null ||\r\n        acteCultural.longitud === null ||\r\n        acteCultural.fi_data < new Date().toISOString().slice(0, 10)\r\n      ) {\r\n        return false;\r\n      }\r\n      const distance = getDistance(\r\n        currentLocation,\r\n        { lat: parseFloat(acteCultural.latitud), lon: parseFloat(acteCultural.longitud) }\r\n      );\r\n      return distance <= 10;\r\n    });\r\n    return filteredData;\r\n  };\r\n\r\n  const getDistance = (start, end) => {\r\n    const deg2rad = (deg) => deg * (Math.PI / 180);\r\n    const R = 6371; // Earth's radius in km\r\n    const dLat = deg2rad(end.lat - start.lat);\r\n    const dLon = deg2rad(end.lon - start.lon);\r\n    const a =\r\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n      Math.cos(deg2rad(start.lat)) *\r\n        Math.cos(deg2rad(end.lat)) *\r\n        Math.sin(dLon / 2) *\r\n        Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    const d = R * c;\r\n    return d;\r\n  };\r\n\r\n  useEffect(() => {\r\n    const currentDate = new Date();\r\n    const formattedDate = currentDate.toISOString().substring(0, 10);\r\n    axios\r\n      .get('https://analisi.transparenciacatalunya.cat/resource/rhpv-yr4f.json?$where=data_fi>%27'+formattedDate+'%27')\r\n      .then((response) => {\r\n        const filteredData = filterByDistance(response.data);\r\n        setActesCulturals(filteredData.map((acteCultural) => acteCultural));\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }, []);\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      {actesCulturals.map((acteCultural, index) => (\r\n        <Text key={index}>{acteCultural}</Text>\r\n      ))}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n});\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}